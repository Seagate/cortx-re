# Text mode or graphical mode?

text

# ---------------------------------------------------
# Define installation source and aditional repos:
# ---------------------------------------------------
# Action
install

# installation path for network installation
cdrom

# Additional repositories.

# Run the Setup Agent on first boot
firstboot --enable

# Reboot after installation
reboot --eject
# poweroff
# ---------------------------------------------------

# ---------------------------------------------------
# Define Language/locale settings:
# ---------------------------------------------------
# System language
lang en_US.UTF-8

# Keyboard layouts
keyboard us
# ---------------------------------------------------

# ---------------------------------------------------
# Define Network, time and timezone settings:
# ---------------------------------------------------
# Network information
network --bootproto=dhcp --noipv6 --hostname=node-1

# Enable firewall
firewall --disabled

# System timezone
timezone --utc America/Denver --ntpservers time.seagate.com
# ---------------------------------------------------

# ---------------------------------------------------
# Define Network, time and timezone settings:
# ---------------------------------------------------
# System authorization information
auth --useshadow --passalgo=sha512

# Root password for system
rootpw --iscrypted $6$qKKoTyoXJO3nzGPR$g3ifgEQOr924HwzElE3D.2lLyZ1m28Vmt9zBuPzJmzZV5oiqyUHz1HB/dkQ9VDpNbiI49UZbm5ko6PtacI3eN/

# ---------------------------------------------------

# ---------------------------------------------------
# Define System services:
# ---------------------------------------------------
services --disabled NetworkManager,gpm,sendmail,cups,pcmcia,isdn,rawdevices,hpoj,bluetooth,openibd,avahi-daemon,avahi-dnsconfd,hidd,hplip,pcscd --enabled sshd,chronyd
# ---------------------------------------------------

# ---------------------------------------------------
# Define Botlooader and partition information:
# ---------------------------------------------------
# System bootloader configuration
autopart
bootloader --location=mbr --append="nofb quiet splash=quiet" 
zerombr

# Partition clearing information
clearpart --all --initlabel

# ---------------------------------------------------
# Define SELinux settings:
# ---------------------------------------------------
selinux --disabled

# If present, X is not configured on the installed system.
skipx

##############################################################################
#
# packages part of the KickStart configuration file
#
##############################################################################
%packages

@Core

#system
yum
dhclient
chrony
wget
sudo
ipmitool
bind-utils
python3
rsync
ftp
sshpass
policycoreutils
policycoreutils-python
python3-pip
rsync
ntp
freeipmi-bmc-watchdog
java-1.8.0-openjdk-headless

#Hare
jq

#csm
kibana-oss
statsd
stats_utils
java-1.8.0-openjdk-headless
elasticsearch-oss
rsyslog-elasticsearch
rsyslog-mmjsonparse

#lustre
kmod-lustre-client
lustre-client

#network
scsi-network-relay
ipmitool
net-tools
firewalld
device-mapper-multipath
ipsec-tools
nmap-ncat.x86_64

#s3server
libxml2
libyaml
yaml-cpp
gflags
glog
python36-boto3
python36-botocore
python36-jmespath
python36-s3transfer
python36-xmltodict
haproxy
s3cmd
openssl-libs
openssl
rpm-build

#aws-client
vim-enhanced
jq
python2-pip
python3
python3-pip
awscli

#logging
logrotate
rsyslog

#openldap
openldap-servers
openldap-clients
selinux-policy

#rabbitmq
erlang
rabbitmq-server

#ha
corosync
pacemaker
pcs
fence-agents-ipmilan

#salt
salt-master
salt-minion
GitPython

#glusterfs
glusterfs-fuse
chrony

%end
##############################################################################
#
# post installation part of the KickStart configuration file
#
##############################################################################
%post
#
# This section describes all the post-Anaconda steps to fine-tune the installation
#

# This line allows printing to console, which otherwise is invisible.
exec < /dev/console > /dev/console

# Housekeeping
echo "Housekeeping.."
/usr/bin/yum -y autoremove
/usr/bin/yum clean all

%end
# %post end
